<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Voz Segura — Verificación adicional</title>

    <link rel="stylesheet" th:href="@{/css/main.css?v=5}" href="/css/main.css?v=5"/>
</head>

<body class="vs-app">

<header class="vs-header">
    <div class="vs-container">

        <div class="vs-brand" aria-label="Voz Segura">
            <img class="vs-brand__logo"
                 th:src="@{/img/logo-voz-segura.svg?v=4}"
                 alt="Logo de Voz Segura">
            <div class="vs-brand__text">
                <div class="vs-brand__title">Voz Segura</div>
                <div class="vs-brand__subtitle">Verificación adicional</div>
            </div>
        </div>

    </div>
</header>

<main class="vs-container">
    <section class="vs-card" aria-labelledby="titulo-verificacion">

        <div class="vs-card__header">
            <h1 id="titulo-verificacion" class="vs-card__title">Verificación adicional</h1>
            <p class="vs-card__subtitle">
                Un paso extra para proteger el acceso. Solo personal autorizado.
            </p>
        </div>

        <div class="vs-alert vs-alert--info vs-mb-4" role="status" aria-live="polite">
            Para continuar, ingresa la clave de verificación y confirma que estás autorizado.
        </div>

        <div th:if="${param.error}" class="vs-alert vs-alert--error vs-mb-4" role="alert" aria-live="polite">
            No se pudo verificar la clave. Inténtalo nuevamente.
        </div>

        <form th:action="@{/auth/verify-secret}"
              method="post"
              th:object="${secretKeyForm}"
              class="vs-form"
              id="secretForm">

            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

            <div class="vs-form__group">
                <label class="vs-form__label vs-form__label--required" for="secretKey">
                    Clave de verificación
                </label>

                <div class="vs-input-with-action">
                    <input
                            type="password"
                            th:field="*{secretKey}"
                            id="secretKey"
                            class="vs-input"
                            required
                            minlength="8"
                            autocomplete="one-time-code"
                            aria-describedby="secretHelp secretError"
                    />
                    <button class="vs-input-action"
                            type="button"
                            aria-label="Mostrar u ocultar clave"
                            data-toggle-password="secretKey">
                        Mostrar
                    </button>
                </div>

                <div id="secretHelp" class="vs-form__help">
                    Mínimo 8 caracteres. No compartas esta clave.
                </div>

                <div id="secretError" class="vs-form__error vs-hidden" role="alert">
                    La clave debe tener al menos 8 caracteres.
                </div>
            </div>

            <label class="vs-checkbox" for="confirmCheck">
                <input type="checkbox"
                       class="vs-checkbox__input"
                       id="confirmCheck"
                       name="confirmAuthorized"
                       value="true"
                       required/>
                <span class="vs-checkbox__label">
                    Confirmo que soy un usuario autorizado.
                </span>
            </label>

            <div class="vs-button-group vs-button-group--space-between vs-mt-6">
                <a th:href="@{/auth/logout}" class="vs-button vs-button--ghost">
                    Cancelar
                </a>

                <button type="submit"
                        class="vs-button vs-button--primary vs-button--lg"
                        id="submitBtn"
                        disabled>
                    Confirmar acceso
                </button>
            </div>

        </form>

    </section>
</main>

<script th:src="@{/js/verify-secret.js}" src="/js/verify-secret.js"></script>

</body>
</html>
