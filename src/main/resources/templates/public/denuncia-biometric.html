<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Voz Segura — Verificación biométrica</title>

    <link rel="stylesheet" th:href="@{/css/main.css?v=5}" href="/css/main.css?v=5"/>
</head>

<body class="vs-app">

<header class="vs-header">
    <div class="vs-container">
        <div class="vs-brand" aria-label="Voz Segura">
            <img class="vs-brand__logo"
                 th:src="@{/img/logo-voz-segura.svg?v=4}"
                 alt="Logo de Voz Segura">
            <div class="vs-brand__text">
                <div class="vs-brand__title">Voz Segura</div>
                <div class="vs-brand__subtitle">Verificación biométrica</div>
            </div>
        </div>
    </div>
</header>

<main class="vs-container">
    <section class="vs-card" aria-labelledby="titulo-bio">

        <div class="vs-card__header">
            <h1 id="titulo-bio" class="vs-card__title">Verificación biométrica</h1>
            <p class="vs-card__subtitle">Sube una fotografía para continuar</p>
        </div>

        <div id="bioUiError" class="vs-alert vs-alert--error vs-mb-4 vs-hidden" role="alert">
            Selecciona una imagen válida antes de continuar.
        </div>

        <div class="vs-camera-container" aria-label="Vista previa de la imagen">
            <div class="vs-camera-preview">
                <div class="vs-camera-frame" id="cameraPlaceholder" aria-hidden="true">
                    <div class="vs-camera-icon" aria-hidden="true"></div>
                </div>

                <img id="photoPreview" class="vs-photo-preview" alt="Vista previa de la fotografía"/>

                <button type="button" class="vs-camera-button" id="pickPhotoBtn" aria-label="Seleccionar fotografía">
                    <span class="vs-sr-only">Seleccionar fotografía</span>
                </button>
            </div>
        </div>

        <div class="vs-info-box" aria-label="Recomendaciones">
            <div class="vs-info-box__title">Recomendaciones</div>
            <ul class="vs-info-box__list">
                <li>Centra el rostro en el marco.</li>
                <li>Usa buena iluminación.</li>
                <li>Evita filtros o imágenes borrosas.</li>
            </ul>
        </div>

        <form th:action="@{/denuncia/biometric}"
              method="post"
              enctype="multipart/form-data"
              th:object="${biometricOtpForm}"
              class="vs-form"
              id="biometricForm">

            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

            <input type="file"
                   th:field="*{biometricSample}"
                   accept="image/*"
                   id="photoInput"
                   class="vs-hidden"
                   required />

            <div class="vs-button-group vs-button-group--space-between">
                <a th:href="@{/auth/login}" class="vs-button vs-button--ghost">
                    Volver al inicio
                </a>

                <button type="submit"
                        class="vs-button vs-button--primary vs-button--lg"
                        id="submitBtn"
                        disabled>
                    Continuar
                </button>
            </div>
        </form>

        <div class="vs-alert vs-alert--info vs-mt-6" role="status" aria-live="polite">
            La imagen se usa únicamente para esta verificación y se maneja de forma segura.
        </div>

    </section>
</main>

<script th:src="@{/js/biometric.js}" src="/js/biometric.js"></script>

</body>
</html>
